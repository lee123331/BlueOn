<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë¸Œëœë“œ ì„¤ê³„ | BlueOn</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;800&display=swap" rel="stylesheet">

<style>
  :root {
    --primary:#0056ff;
    --primary-dark:#0037c2;
    --bg:#f8faff;
    --white:#ffffff;
    --text:#111827;
    --gray:#6b7280;
    --line:#e5e7eb;
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{
    font-family:"Noto Sans KR",sans-serif;
    background:var(--bg);
    color:var(--text);
  }

  /* HEADER */
  header{
    padding:18px 60px;
    background:var(--white);
    border-bottom:1px solid var(--line);
    font-weight:800;
    color:var(--primary);
    font-size:22px;
    cursor:pointer;
    position:sticky;
    top:0;
    z-index:100;
  }

  /* WRAPPER */
  .wrap{
    display:flex;
    max-width:1400px;
    margin:40px auto;
    gap:32px;
    padding:0 30px;
  }

  /* LEFT STEPS */
  .steps{
    width:260px;
  }
  .step-item{
    padding:16px 18px;
    border:1px solid var(--line);
    background:#fff;
    border-radius:12px;
    margin-bottom:14px;
    cursor:pointer;
    transition:.2s;
  }
  .step-item.active{
    border-color:var(--primary);
    background:#eef4ff;
    color:var(--primary);
    font-weight:700;
  }

  /* RIGHT MAIN */
  .main{
    flex:1;
  }
  .step-title{
    font-size:26px;
    font-weight:800;
    margin-bottom:20px;
  }
  .sub-title{
    margin:22px 0 8px;
    font-size:15px;
    font-weight:700;
  }
  .input-box{
    width:100%;
    background:#fff;
    border:1px solid var(--line);
    border-radius:10px;
    padding:14px 16px;
    font-size:14px;
    resize:none;
    min-height:100px;
    margin-bottom:14px;
  }
  .small-box{
    min-height:50px;
  }

  /* RESULT PANEL */
  .result-panel{
    margin-top:40px;
    background:#fff;
    border-radius:12px;
    padding:20px;
    border:1px solid #e3e7ef;
  }
  .result-title{
    font-size:20px;
    font-weight:800;
    margin-bottom:12px;
  }
  .result-item{
    margin-bottom:20px;
  }
  .label{
    font-size:14px;
    font-weight:700;
    margin-bottom:4px;
  }
  .value{
    padding:12px 14px;
    background:#f7f9ff;
    border-radius:8px;
    border:1px solid #e2e6f3;
    font-size:14px;
    white-space:pre-line;
  }

  /* í‚¤ì›Œë“œ íƒœê·¸ ìŠ¤íƒ€ì¼ */
  .keyword-box {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 10px;
  }
  .keyword-chip {
    background: #eaf1ff;
    color: #0056ff;
    padding: 6px 12px;
    border-radius: 999px;
    font-size: 13px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .keyword-chip span {
    cursor: pointer;
    font-weight: 800;
    opacity: 0.8;
  }
  .keyword-chip span:hover {
    opacity: 1;
  }

  /* ì„ íƒ ì¹´ë“œ */
  .select-card-wrap {
    display: flex;
    flex-wrap: wrap;
    gap: 14px;
    margin-top: 12px;
  }
  .select-card {
    padding: 14px 18px;
    background: #ffffff;
    border: 2px solid #e5e7eb;
    border-radius: 12px;
    cursor: pointer;
    transition: .25s;
    font-weight: 600;
    color: #111827;
  }
  .select-card:hover {
    border-color: #b2ccff;
  }
  .select-card.active {
    border-color: #0056ff;
    background: #eaf1ff;
    color: #0056ff;
  }

  /* í‚¤ì›Œë“œ ì¶”ê°€ ë²„íŠ¼ */
  #addKeywordBtn {
    height: 48px;
    padding: 0 20px;
    margin-top: -12px;
    background: #0056ff;
    color: #fff;
    border: none;
    border-radius: 10px;
    font-weight: 700;
    cursor: pointer;
  }
  /* ======================
   STEP2 ì¹´í…Œê³ ë¦¬ ì„ íƒ UI
====================== */
.category-select-wrap {
  display: flex;
  gap: 20px;
  margin-top: 20px;
}

/* íŒ¨ë„ (ì¢Œ/ì¤‘/ìš°) */
.category-panel {
  width: 30%;
  background: #fff;
  border: 1px solid var(--line);
  border-radius: 12px;
  padding: 15px;
  height: 420px;
  overflow-y: auto;
}

.panel-title {
  font-size: 15px;
  font-weight: 700;
  margin-bottom: 10px;
}

/* ë¦¬ìŠ¤íŠ¸ */
.category-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.category-item {
  padding: 12px 14px;
  background: #ffffff;
  border: 1px solid #e5e7eb;
  border-radius: 10px;
  cursor: pointer;
  transition: 0.2s;
  font-size: 14px;
  font-weight: 600;
}

.category-item:hover {
  background: #f2f7ff;
  border-color: #b9ceff;
}

.category-item.active {
  border-color: #0056ff;
  background: #eaf1ff;
  color: #0056ff;
}

/* ì„ íƒê²°ê³¼ */
.selected-panel {
  width: 30%;
  background: #fff;
  border: 1px solid var(--line);
  border-radius: 12px;
  padding: 15px;
  height: 420px;
  overflow-y: auto;
}

.selected-header {
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
  font-weight: 700;
  color: var(--text);
}

.selected-header button {
  background: none;
  border: none;
  color: #0056ff;
  font-size: 13px;
  cursor: pointer;
}

.selected-items {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

/* ì„ íƒëœ íƒœê·¸ UI */
.selected-tag {
  background: #eaf1ff;
  border: 1px solid #d3dfff;
  color: #0056ff;
  border-radius: 999px;
  padding: 6px 10px;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 6px;
}

.selected-tag span {
  cursor: pointer;
  font-weight: 800;
}
.input-error {
  border: 2px solid #ff4d4d !important;
  background: #fff5f5 !important;
}

.alert-text {
  color: #ff4d4d;
  font-size: 13px;
  margin-top: 6px;
}

</style>
</head>

<body>

<header 
  style="
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 18px 60px;
    background: #fff;
    border-bottom: 1px solid #e5e7eb;
  "
>
  <!-- ê¸°ì¡´ BlueOn ìœ ì§€ -->
  <div 
    onclick="location.href='index.html'"
    style="font-weight: 800; color: #0056ff; font-size: 22px; cursor: pointer;"
  >
    BlueOn
  </div>

  <!-- ğŸ”µ ë“±ë¡í•˜ê¸° ë²„íŠ¼ -->
  <button
    id="saveBrandBtn"
    style="
      padding: 10px 20px;
      background: #0056ff;
      color: white;
      font-weight: 700;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
    "
  >
    ë“±ë¡í•˜ê¸°
  </button>
</header>


<div class="wrap">

  <!-- LEFT STEP MENU -->
  <div class="steps">
    <div class="step-item active" data-step="1">1ë‹¨ê³„ Â· ë¸Œëœë“œ ê¸°ì´ˆ ì„¤ê³„</div>
    <div class="step-item" data-step="2">2ë‹¨ê³„ Â· ì „ëµ ì •êµí™”</div>
    <div class="step-item" data-step="3">3ë‹¨ê³„ Â· ì‹¤í–‰ Â· í™•ì¥</div>
  </div>

  <!-- RIGHT MAIN AREA -->
  <div class="main">

    <!-- STEP 1 -->
    <div class="step-content" id="step1">
      <div class="step-title">1ë‹¨ê³„ Â· ë¸Œëœë“œ ê¸°ì´ˆ ì„¤ê³„</div>

      <!-- ğŸ”µ í‚¤ì›Œë“œ ì…ë ¥ë€ -->
      <div class="sub-title">ë¸Œëœë“œ í•µì‹¬ í‚¤ì›Œë“œ</div>

      <div style="display:flex;gap:10px;align-items:center;">
        <input 
          id="keywordInput"
          type="text"
          class="input-box small-box"
          placeholder="ì˜ˆ) ê³ ê¸‰ìŠ¤ëŸ¬ìš´, ì¹œí™˜ê²½, ê°ì„±ì ì¸"
          style="flex:1; min-height:48px;"
        />
        <button id="addKeywordBtn">ì¶”ê°€</button>
      </div>

      <!-- í‚¤ì›Œë“œ íƒœê·¸ í‘œì‹œ -->
      <div id="keywordList" class="keyword-box"></div>

      <!-- ğŸ”µ ìŠ¤í† ë¦¬ -->
      <div class="sub-title" style="margin-top:25px;">ë¸Œëœë“œ ë¯¸ì…˜ Â· ìŠ¤í† ë¦¬</div>
      <textarea 
        id="story" 
        class="input-box" 
        placeholder="ë¸Œëœë“œê°€ í•´ê²°í•˜ë ¤ëŠ” ë¬¸ì œ, ì‹œì‘ ë°°ê²½ ë“±ì„ ì ì–´ì£¼ì„¸ìš”."></textarea>
        <!-- ğŸ”µ ë¸Œëœë“œ ì»¨ì…‰ -->
<div class="sub-title" style="margin-top:25px;">ë¸Œëœë“œ ì»¨ì…‰</div>
<textarea
  id="brandConcept"
  class="input-box"
  placeholder="ë¸Œëœë“œì˜ í•µì‹¬ ì»¨ì…‰ì„ ì ì–´ì£¼ì„¸ìš”. ì˜ˆ: ê°ê°ì ì¸ ë¯¸ë‹ˆë©€ë¦¬ì¦˜, í”„ë¦¬ë¯¸ì—„ ê°„ê²°í•¨, ë‚´ì¶”ëŸ´ í†¤ UI ë“±"
></textarea>

    </div>

   <!-- STEP 2 -->
<div class="step-content" id="step2" style="display:none;">
  <div class="step-title">2ë‹¨ê³„ Â· ë¸Œëœë“œ ë°©í–¥ ì„¤ì •</div>

  <!-- ğŸ”µ í¬ëª½ ìŠ¤íƒ€ì¼ 3ë‹¨ ì¹´í…Œê³ ë¦¬ UI -->
  <div class="category-select-wrap">

    <!-- ìƒìœ„ ì¹´í…Œê³ ë¦¬ -->
    <div class="category-panel">
      <div class="panel-title">í†¤ & ë¬´ë“œ</div>
      <div id="toneCategoryList" class="category-list"></div>
    </div>

    <!-- í•˜ìœ„ ì¹´í…Œê³ ë¦¬ -->
    <div class="category-panel">
      <div class="panel-title">ì„¸ë¶€ í†¤ & ë¬´ë“œ</div>
      <div id="toneSubList" class="category-list"></div>
    </div>

    <!-- ì„ íƒëœ íƒœê·¸ -->
    <div class="selected-panel">
      <div class="selected-header">
        <span><span id="selectedCount">0</span>/20</span>
        <button id="clearSelected">ì „ì²´ì‚­ì œ</button>
      </div>
      <div id="selectedItems" class="selected-items"></div>
    </div>

  </div>
</div>


     
    <!-- STEP 3 -->
<div class="step-content" id="step3" style="display:none;">
  <div class="step-title">3ë‹¨ê³„ Â· ë¸Œëœë“œ í™•ì‚° & í™•ì¥ ì „ëµ</div>

  <div class="sub-title">ì´ˆê¸° íƒ€ê¹ƒ ê³ ê°</div>
  <input 
    id="targetCustomer"
    class="input-box"
    placeholder="ì˜ˆ) ì‡¼í•‘ëª° ì°½ì—…ì, ì˜¨ë¼ì¸ íŒë§¤ì, ì†Œìƒê³µì¸"
  />

  <!-- ğŸ”µ ìƒÂ·í•˜ìœ„ í™•ì‚° ê²½ë¡œ ì„ íƒ UI -->
  <div class="sub-title" style="margin-top:25px;">ë¸Œëœë“œ í™•ì‚° ê²½ë¡œ</div>

  <div class="category-select-wrap" id="spreadCategoryWrap">

    <!-- ìƒìœ„ ì¹´í…Œê³ ë¦¬ -->
    <div class="category-panel">
      <div class="panel-title">ìƒìœ„ í™•ì‚° ì±„ë„</div>
      <div class="category-list" id="spreadCategoryList"></div>
    </div>

    <!-- í•˜ìœ„ ì˜µì…˜ -->
    <div class="category-panel">
      <div class="panel-title">ì„¸ë¶€ ì±„ë„ ì˜µì…˜</div>
      <div class="category-list" id="spreadSubList"></div>
    </div>

    <!-- ì„ íƒ ê²°ê³¼ -->
    <div class="selected-panel">
      <div class="selected-header">
  <span id="spreadSelectedCount">0/20</span>
  <button id="spreadClearSelected">ì „ì²´ì‚­ì œ</button>
</div>

      <div class="selected-items" id="spreadSelectedItems"></div>
    </div>

  </div>

  <!-- ğŸ”µ í–¥í›„ í™•ì¥ ê³„íš -->
  <div class="sub-title" style="margin-top:25px;">í–¥í›„ í™•ì¥ ê³„íš</div>
  <textarea 
    id="expandPlan"
    class="input-box"
    placeholder="í–¥í›„ ë¸Œëœë“œê°€ ì–´ë–¤ ë°©í–¥ìœ¼ë¡œ í™•ì¥ë˜ê¸¸ ì›í•˜ëŠ”ì§€ ì ì–´ì£¼ì„¸ìš”. ì˜ˆ: ì•± ì¶œì‹œ, ì „ë¬¸ ì„œë¹„ìŠ¤ í™•ëŒ€, ê¸€ë¡œë²Œ í™•ì¥ ë“±"></textarea>

</div>


    <!-- RESULT SECTION -->
    <div class="result-panel">
      <div class="result-title">ë¸Œëœë“œ ì„¤ê³„ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°</div>

      <div class="result-item">
        <div class="label">ë¸Œëœë“œ í•µì‹¬ í‚¤ì›Œë“œ</div>
        <div id="r_keyword" class="value"></div>
      </div>

      <div class="result-item">
        <div class="label">ë¸Œëœë“œ ìŠ¤í† ë¦¬</div>
        <div id="r_story" class="value"></div>
      </div>

      <div class="result-item">
        <div class="label">ë¸Œëœë“œ í†¤ & ë¬´ë“œ</div>
        <div id="r_tone" class="value"></div>
      </div>

      <div class="result-item">
        <div class="label">ë¸Œëœë“œ ì»¨ì…‰</div>
        <div id="r_concept" class="value"></div>
      </div>

      <div class="result-item">
        <div class="label">íƒ€ê¹ƒ ê³ ê°</div>
        <div id="r_target" class="value"></div>
      </div>

      <div class="result-item">
        <div class="label">ë¸Œëœë“œ í™•ì‚° ê²½ë¡œ</div>
        <div id="r_spread" class="value"></div>
      </div>

      <div class="result-item">
        <div class="label">í–¥í›„ í™•ì¥ ê³„íš</div>
        <div id="r_expand" class="value"></div>
      </div>
    </div>

  </div>
</div>

<script>
  /* STEP MENU */
const stepBtns = document.querySelectorAll(".step-item");
const contents = document.querySelectorAll(".step-content");

stepBtns.forEach(btn => {
  btn.onclick = () => {
    stepBtns.forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    const step = btn.dataset.step;

    contents.forEach(c => c.style.display = "none");
    document.getElementById(`step${step}`).style.display = "block";
  };
});

/* ================================
   STEP1 : í‚¤ì›Œë“œ + ë¸Œëœë“œ ì»¨ì…‰ ì…ë ¥ ê¸°ëŠ¥
================================ */

// DOM ìš”ì†Œ
const keywordInput = document.getElementById("keywordInput");
const addKeywordBtn = document.getElementById("addKeywordBtn");
const keywordList = document.getElementById("keywordList");

const brandConceptInput = document.getElementById("brandConcept"); // ğŸ”µ ë¸Œëœë“œ ì»¨ì…‰ ì…ë ¥ DOM

// ë°ì´í„°
let keywords = [];

/* í‚¤ì›Œë“œ ëª©ë¡ ë Œë”ë§ */
function renderKeywords() {
  keywordList.innerHTML = "";
  keywords.forEach((kw, index) => {
    const chip = document.createElement("div");
    chip.className = "keyword-chip";
    chip.innerHTML = `
      ${kw}
      <span data-index="${index}">Ã—</span>
    `;
    keywordList.appendChild(chip);
  });
}

/* í‚¤ì›Œë“œ ì¶”ê°€ */
addKeywordBtn.onclick = () => {
  const text = keywordInput.value.trim();
  if (!text) return;

  keywords.push(text);
  keywordInput.value = "";
  renderKeywords();
  syncResults();
};

/* í‚¤ì›Œë“œ ì‚­ì œ */
keywordList.addEventListener("click", (e) => {
  if (e.target.tagName === "SPAN") {
    const index = e.target.dataset.index;
    keywords.splice(index, 1);
    renderKeywords();
    syncResults();
  }
});

/* ë¸Œëœë“œ ì»¨ì…‰ ì…ë ¥ ê°ì§€ */
if (brandConceptInput) {
  brandConceptInput.addEventListener("input", syncResults);
}

/* =============================
   STEP2 ë°ì´í„° êµ¬ì¡° ì •ì˜
============================= */
const toneCategoryData = {
  "í”„ë¦¬ë¯¸ì—„": [
    "ê³ ê¸‰ìŠ¤ëŸ¬ìš´", "ì°¨ë¶„í•œ", "í•˜ì´ì—”ë“œ", "í’ˆê²©ìˆëŠ”", "ëŸ­ì…”ë¦¬ ì»¬ëŸ¬í†¤",
    "í”„ë¦¬ë¯¸ì—„ ê°„ê²°í•¨", "ë¼ìš´ë“œ ì—£ì§€", "ë¶€ë“œëŸ¬ìš´ ìƒ‰ìƒ", "ê³ ê¸‰ ì§ˆê° UI",
    "ìŠ¤í˜ì…œí‹° ë ˆì´ì•„ì›ƒ", "ë¸Œëœë“œ ì‹ ë¢°ê°", "ì ˆì œëœ í…ìŠ¤íŠ¸ êµ¬ì¡°",
    "ë¸”ë™&ê³¨ë“œ í¬ì¸íŠ¸", "ë”¥ë¸”ë£¨ í¬ì¸íŠ¸", "ì‹¬í”Œ ë¦¬ì¹˜ ë””ìì¸",
    "ì •êµí•œ ê°„ê²©ê°", "ëª¨ë˜ í•˜ì´í´ë˜ìŠ¤", "ê°ê°ì  ë””í…Œì¼ë§",
    "ë¬´ê´‘ ì§ˆê° ìŠ¤íƒ€ì¼", "ë¸Œëœë“œ ì¤‘ì‹¬ í¬ì»¤ìŠ¤"
  ],
  "ì¹œí™˜ê²½": [
    "ê·¸ë¦° ì»¬ëŸ¬í†¤", "ë‚´ì¶”ëŸ´ í†¤", "ìš°ë“œ í…ìŠ¤ì²˜", "í™˜ê²½ ì¹œí™” ë©”ì‹œì§€",
    "ìì—°ê´‘ ëŠë‚Œ", "í”Œë« ë‚´ì¶”ëŸ´ UI", "ì‹¬í”Œ ìì—° ê°ì„±",
    "íŒŒìŠ¤í…” ê·¸ë¦°", "ë² ì´ì§€ í†¤", "í”ŒëœíŠ¸ ëª¨í‹°ë¸Œ",
    "í´ë¦° ê·¸ë¦° ë””ìì¸", "ë¯¸ë‹ˆ ë‚´ì¶”ëŸ´ UI", "ì¹œí™˜ê²½ í¬ì¸íŠ¸ ìš”ì†Œ",
    "ì‹ë¬¼ ì´ë¯¸ì§€ ì¡°í™”", "ì†Œí”„íŠ¸ ë‚´ì¶”ëŸ´ ë¼ìš´ë“œ",
    "ê·¸ë¦° í¬ì»¤ìŠ¤", "ë‚´ì¶”ëŸ´ í…ìŠ¤ì²˜ ê·¸ë˜í”½", "ì§€ì†ê°€ëŠ¥ì„± í…Œë§ˆ",
    "ì—ì½” UI ì»´í¬ë„ŒíŠ¸", "ìì—°ê³¼ ì–´ìš¸ë¦¬ëŠ” ì»¬ëŸ¬ ì¡°í•©"
  ],
  "ê°ì„±ì ì¸": [
    "ë”°ëœ»í•œ ë¶„ìœ„ê¸°", "ë¶€ë“œëŸ¬ìš´ í†¤", "ê°ì„± ì»¬ëŸ¬", "ë”°ëœ»í•œ ë² ì´ì§€",
    "ë ˆíŠ¸ë¡œ ê°ì„±", "ì•„ë‚ ë¡œê·¸ í†¤", "ë¹› ë²ˆì§ ê·¸ë˜í”½", "ì†Œí”„íŠ¸ ì‰ë„ìš°",
    "ë¶€ë“œëŸ¬ìš´ íƒ€ì´í¬", "ì†ê¸€ì”¨ ëŠë‚Œ", "ê°ì„± í¬í†  ìŠ¤íƒ€ì¼",
    "ë¹ˆí‹°ì§€ ìƒ‰ê°", "í¬ê·¼í•œ ì—°ì¶œ", "ì•„ê¸°ìê¸°í•œ ìš”ì†Œ",
    "ë”°ëœ»í•œ ìŒì˜", "ê¿ˆê°™ì€ ì§ˆê°", "ì›œí†¤ ìœ„ì£¼ ë ˆì´ì•„ì›ƒ",
    "ì‚¬ì§„ ì¤‘ì‹¬ ê°ì„±", "ë¼ì´íŠ¸ ëª¨ë…¸í†¤", "ì¼ê¸°ì¥ ìŠ¤íƒ€ì¼"
  ],
  "í™œê¸°ì°¬": [
    "ê°•ë ¬í•œ ìƒ‰ê°", "í™œë™ì ì¸ UI", "ì„ ëª…í•œ ëŒ€ë¹„", "ì—ë„ˆì§€ ì»¬ëŸ¬",
    "ìŠ¤í¬í‹° ê°ì„±", "ìµì‚¬ì´íŒ… ê·¸ë˜í”½", "ì„ ëª…í•œ í¬ì¸íŠ¸", "ë¹„ë¹„ë“œí†¤",
    "ë°°ê²½ ëŒ€ë¹„ê°€ ê°•í•¨", "í‚¤ ì»¬ëŸ¬ ê°•ì¡°", "ì†ë„ê° ìˆëŠ” ë ˆì´ì•„ì›ƒ",
    "ìµìŠ¤íŠ¸ë¦¼ ê°ì„±", "ë°œë„í•œ ìƒ‰ ì¡°í•©", "í¬ë™í¬ë™ ìŠ¤íƒ€ì¼",
    "ì›ìƒ‰ ì¡°í•©", "ì¥ë‚œê¸° ìˆëŠ” ëŠë‚Œ", "ìœ ì¾Œí•œ ì—°ì¶œ",
    "í™œë™ ì¤‘ì‹¬ êµ¬ì¡°", "ì„ ëª…í•œ ê·¸ë˜í”½ ìš”ì†Œ", "ë¹„ë¹„ë“œ ë¼ìš´ë“œ"
  ],
  "ë¯¸ë‹ˆë©€": [
    "í™”ì´íŠ¸ ê¸°ë°˜", "ê³µë°± ë§ì€ êµ¬ì„±", "ê¹”ë”í•œ UI", "ì ˆì œëœ í†¤",
    "ëª¨ë˜ ì‹¬í”Œ", "ì–‡ì€ ë¼ì¸", "ê·¸ë¦¬ë“œ ì¤‘ì‹¬ êµ¬ì¡°",
    "ë¸”ë™&í™”ì´íŠ¸ ê¸°ë°˜", "êµ°ë”ë”ê¸° ì—†ìŒ", "ìµœì†Œ í¬ì¸íŠ¸ ì»¬ëŸ¬",
    "ê· í˜• ì¡íŒ ì—¬ë°±", "ë¼ì´íŠ¸ UI", "ëŒ€ì¹­ì ì¸ ë°°ì¹˜",
    "ë¯¸ë‹ˆë©€ íƒ€ì´í¬", "ì‹¬í”Œ ë¼ìš´ë“œ", "ëª¨ë…¸ ë¼ì´íŠ¸ í†¤",
    "ë‹¨ìˆœ ì¸í„°í˜ì´ìŠ¤", "ì •ì ì¸ êµ¬ì¡°", "ì°¨ë¶„í•œ ë¯¸ë‹ˆë©€ë¦¬ì¦˜",
    "í•„ìš” ìš”ì†Œë§Œ ë°°ì¹˜"
  ],
  "ì „ë¬¸ì ì¸": [
    "ë¹„ì¦ˆë‹ˆìŠ¤ í†¤", "ì‹ ë¢° ì¤‘ì‹¬ UI", "ê¹”ë”í•œ ì •ë³´ êµ¬ì¡°",
    "ë°ì´í„° ê¸°ë°˜ ëŠë‚Œ", "í¬ë©€í•œ ì»¬ëŸ¬í†¤", "ë„¤ì´ë¹„ ì¤‘ì‹¬ ìƒ‰ê°",
    "ì •í™•í•œ ì¸í¬ê·¸ë˜í”½", "ì‹ ë¢°ê° ë†’ì€ í°íŠ¸", "ë¼ì´íŠ¸ ë¸”ë£¨ í¬ì¸íŠ¸",
    "ê¸°ì—…í˜• ë ˆì´ì•„ì›ƒ", "ì°¨ë¶„í•œ ë°°ê²½í†¤", "ì •ì¹˜í•œ ë¼ì¸ êµ¬ì„±",
    "ë¬¸ì„œ ì¤‘ì‹¬ êµ¬ì¡°", "ì •í™•í•œ ë©”ì‹œì§€ ì „ë‹¬", "ê¼¼ê¼¼í•œ ì •ë³´ UI",
    "ì‹¬í”Œí•œ ì¹´ë“œí˜• êµ¬ì¡°", "ê¸°ì—…í˜• ì¸í„°í˜ì´ìŠ¤",
    "ë¹„ì¦ˆë‹ˆìŠ¤ í™”ì´íŠ¸í†¤", "ì •ì„ì  êµ¬ì„±", "ê´€ë¡ìˆëŠ” ëŠë‚Œ"
  ]
};

/* =============================
   STEP2 DOM ìš”ì†Œ  
============================= */
const toneCategoryList = document.getElementById("toneCategoryList");
const toneSubList = document.getElementById("toneSubList");
const toneSelectedItems = document.getElementById("selectedItems");
const toneSelectedCount = document.getElementById("selectedCount");
const toneClearSelected = document.getElementById("clearSelected");

let currentCategory = "";
let selectedTags = [];

/* STEP2: ìƒìœ„ ì¹´í…Œê³ ë¦¬ ë Œë”ë§ */
function renderToneCategories() {
  toneCategoryList.innerHTML = "";

  Object.keys(toneCategoryData).forEach(cat => {
    const div = document.createElement("div");
    div.className = "category-item";
    div.textContent = cat;

    div.onclick = () => {
      currentCategory = cat;

      document.querySelectorAll("#toneCategoryList .category-item")
        .forEach(el => el.classList.remove("active"));
      div.classList.add("active");

      renderToneSubList(cat);
    };

    toneCategoryList.appendChild(div);
  });
}

/* STEP2: í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ë Œë”ë§ */
function renderToneSubList(cat) {
  toneSubList.innerHTML = "";

  toneCategoryData[cat].forEach(sub => {
    const div = document.createElement("div");
    div.className = "category-item";
    div.textContent = sub;

    div.onclick = () => selectToneTag(sub);

    toneSubList.appendChild(div);
  });
}

/* STEP2: íƒœê·¸ ì„ íƒ */
function selectToneTag(name) {
  if (selectedTags.includes(name)) return;
  if (selectedTags.length >= 20) {
    showToast("ìµœëŒ€ 20ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤!");
    return;
  }

  selectedTags.push(name);
  renderToneSelected();
  syncResults();
}

/* STEP2: ì„ íƒ ë Œë”ë§ */
function renderToneSelected() {
  toneSelectedItems.innerHTML = "";

  selectedTags.forEach((tag, i) => {
    const div = document.createElement("div");
    div.className = "selected-tag";
    div.innerHTML = `
      ${tag}
      <span data-i="${i}">Ã—</span>
    `;
    toneSelectedItems.appendChild(div);
  });

  toneSelectedCount.textContent = selectedTags.length;
}

/* STEP2: ì‚­ì œ */
toneSelectedItems.addEventListener("click", (e) => {
  if (e.target.tagName === "SPAN") {
    const index = e.target.dataset.i;
    selectedTags.splice(index, 1);
    renderToneSelected();
    syncResults();
  }
});

/* STEP2: ì „ì²´ì‚­ì œ */
toneClearSelected.onclick = () => {
  selectedTags = [];
  renderToneSelected();
  syncResults();
};

/* =============================
   STEP3 í™•ì‚° ê²½ë¡œ ë°ì´í„° êµ¬ì¡°
============================= */
const spreadCategoryData = {
  "SNS ì¤‘ì‹¬": [
    "ì¸ìŠ¤íƒ€ê·¸ë¨ ë¦´ìŠ¤", "í‹±í†¡ ìˆí¼", "íŒ”ë¡œì›Œ íƒ€ê²Ÿ ê´‘ê³ ", "UGC ì½˜í…ì¸ ",
    "ì¸í”Œë£¨ì–¸ì„œ ì½œë¼ë³´", "ë¸Œëœë””ë“œ ìˆí¼", "ìŠ¤í† ë¦¬ í™ë³´",
    "SNS ë°”ì´ëŸ´ ìº í˜ì¸", "ì½˜í…ì¸  ì‹œë¦¬ì¦ˆ ì œì‘", "í•´ì‹œíƒœê·¸ í•„í„°ë§"
  ],
  "ê²€ìƒ‰ ê¸°ë°˜": [
    "ë„¤ì´ë²„ ë¸”ë¡œê·¸ ìƒìœ„ë…¸ì¶œ", "í‚¤ì›Œë“œ ë§ˆì¼€íŒ…", "SEO ìµœì í™”",
    "ìƒí’ˆ ë¦¬ë·° ê°•í™”", "ë„¤ì´ë²„ ì‡¼í•‘ ê²€ìƒ‰ ëŒ€ì‘", "ì½˜í…ì¸  í‚¤ì›Œë“œ ë§µ",
    "ê²€ìƒ‰í˜• FAQ êµ¬ì¶•", "ë¸Œëœë“œ í‚¤ì›Œë“œ ì ìœ ",
    "ë„¤ì´ë²„ í¬ìŠ¤íŠ¸ ìµœì í™”", "êµ¬ê¸€ SEO ì „ëµ"
  ],
  "ì»¤ë®¤ë‹ˆí‹° ê¸°ë°˜": [
    "ì¹´í˜ ì²´í—˜ë‹¨", "ì¹´í˜ ì§€ì‹in ê³µëµ", "ì˜¤í”ˆì±„íŒ…ë°© ìš´ì˜",
    "ë‹ˆì¹˜ ì»¤ë®¤ë‹ˆí‹° ê³µëµ", "ì‹¤ì‚¬ìš© í›„ê¸° í™•ë³´", "ë‹¨í†¡ë°© ë¸Œëœë”©",
    "í™œë°œí•œ Q&A ê²Œì‹œë¬¼ ìš´ì˜", "ì „ë¬¸ ì»¤ë®¤ë‹ˆí‹° ìŠ¤í°ì„œ",
    "ê³ ê° ëª¨ì„ ê¸°íš", "ê³µë™êµ¬ë§¤ ì§„í–‰"
  ],
  "ì½˜í…ì¸  ê¸°ë°˜": [
    "ìœ íŠœë¸Œ ì˜ìƒ ì œì‘", "ë¸ŒëŸ°ì¹˜ ê¸€ì“°ê¸°", "ë…¸ì…˜ ëœë”©í˜ì´ì§€",
    "ì˜¨ë¼ì¸ ê°•ì˜ ì½˜í…ì¸ ", "ë¸Œëœë“œ ì¸í„°ë·° ì˜ìƒ",
    "í¬íŠ¸í´ë¦¬ì˜¤ ì˜ìƒ", "í™œìš© ì‚¬ë¡€ ì½˜í…ì¸ ", "ë¯¸ë‹ˆ ë‹¤í ìŠ¤íƒ€ì¼ ì˜ìƒ",
    "ì œí’ˆ ë¦¬ë·° ì½˜í…ì¸ ", "ë¸”ë¡œê·¸í˜• ì½˜í…ì¸  ë¬¶ìŒ ì œì‘"
  ]
};

/* =============================
   STEP3 DOM ìš”ì†Œ  
============================= */
const spreadCategoryList = document.getElementById("spreadCategoryList");
const spreadSubList = document.getElementById("spreadSubList");
const spreadSelectedItems = document.getElementById("spreadSelectedItems");
const spreadSelectedCount = document.getElementById("spreadSelectedCount");
const spreadClearSelected = document.getElementById("spreadClearSelected");

let currentSpreadCategory = "";
let selectedSpreadTags = [];

/* STEP3: ìƒìœ„ ë Œë”ë§ */
function renderSpreadCategories() {
  spreadCategoryList.innerHTML = "";

  Object.keys(spreadCategoryData).forEach(cat => {
    const div = document.createElement("div");
    div.className = "category-item";
    div.textContent = cat;

    div.onclick = () => {
      currentSpreadCategory = cat;

      document.querySelectorAll("#spreadCategoryList .category-item")
        .forEach(el => el.classList.remove("active"));
      div.classList.add("active");

      renderSpreadSubList(cat);
    };

    spreadCategoryList.appendChild(div);
  });
}

/* STEP3: í•˜ìœ„ ë Œë”ë§ */
function renderSpreadSubList(cat) {
  spreadSubList.innerHTML = "";

  spreadCategoryData[cat].forEach(sub => {
    const div = document.createElement("div");
    div.className = "category-item";
    div.textContent = sub;

    div.onclick = () => selectSpreadTag(sub);

    spreadSubList.appendChild(div);
  });
}

/* STEP3: íƒœê·¸ ì„ íƒ */
function selectSpreadTag(tag) {
  if (selectedSpreadTags.includes(tag)) return;
  if (selectedSpreadTags.length >= 20) {
    ashowToast("ìµœëŒ€ 20ê°œê¹Œì§€ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    return;
  }

  selectedSpreadTags.push(tag);
  renderSpreadSelected();
  syncResults();
}

/* STEP3: ì„ íƒ ë Œë”ë§ */
function renderSpreadSelected() {
  spreadSelectedItems.innerHTML = "";

  selectedSpreadTags.forEach((tag, i) => {
    const div = document.createElement("div");
    div.className = "selected-tag";
    div.innerHTML = `
      ${tag}
      <span data-i="${i}">Ã—</span>
    `;
    spreadSelectedItems.appendChild(div);
  });

  spreadSelectedCount.textContent = `${selectedSpreadTags.length}/20`;
}

/* STEP3: ì‚­ì œ */
spreadSelectedItems.addEventListener("click", (e) => {
  if (e.target.tagName === "SPAN") {
    const index = e.target.dataset.i;
    selectedSpreadTags.splice(index, 1);
    renderSpreadSelected();
    syncResults();
  }
});

/* STEP3: ì „ì²´ì‚­ì œ */
spreadClearSelected.onclick = () => {
  selectedSpreadTags = [];
  renderSpreadSelected();
  syncResults();
};

/* ì…ë ¥ ë°˜ì˜ */
document.getElementById("story").addEventListener("input", syncResults);
document.getElementById("targetCustomer").addEventListener("input", syncResults);
document.getElementById("expandPlan").addEventListener("input", syncResults);

/* ---------------------------------------
     ê²°ê³¼ íŒ¨ë„ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
----------------------------------------*/
function syncResults() {
  // í‚¤ì›Œë“œ
  document.getElementById("r_keyword").textContent =
    keywords.join(", ");

  // ìŠ¤í† ë¦¬
  document.getElementById("r_story").textContent =
    document.getElementById("story").value;

  // í†¤ & ë¬´ë“œ (STEP2)
  document.getElementById("r_tone").textContent =
    selectedTags.length ? selectedTags.join(", ") : "";

  // ë¸Œëœë“œ ì»¨ì…‰ (STEP1)
  document.getElementById("r_concept").textContent =
    document.getElementById("brandConcept").value;

  // íƒ€ê¹ƒ ê³ ê° (STEP3)
  document.getElementById("r_target").textContent =
    document.getElementById("targetCustomer").value;

  // í™•ì‚° ê²½ë¡œ (STEP3)
  document.getElementById("r_spread").textContent =
    selectedSpreadTags.join(", ");

  // í™•ì¥ ê³„íš (STEP3)
  document.getElementById("r_expand").textContent =
    document.getElementById("expandPlan").value;
}

/* ================================
   ğŸ”µ ë¸Œëœë“œ ì„¤ê³„ ì €ì¥ ê¸°ëŠ¥
================================ */
document.getElementById("saveBrandBtn").onclick = async () => {

  const story = document.getElementById("story");
  const concept = document.getElementById("brandConcept");
  const targetCustomer = document.getElementById("targetCustomer");
  const expandPlan = document.getElementById("expandPlan");

  resetError(keywordInput);
  resetError(story);
  resetError(concept);
  resetError(targetCustomer);
  resetError(expandPlan);

  /* ======================================
      ğŸ”µ STEP 1 â€” ì²« ë²ˆì§¸ ë¯¸ì¶©ì¡± í•­ëª©ë§Œ ì•ŒëŒ
  =======================================*/
  if (keywords.length === 0) {
    showFieldError(keywordInput, "í‚¤ì›Œë“œë¥¼ 1ê°œ ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    showToast("í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return; // â— í•˜ë‚˜ë§Œ ì•Œë ¤ì£¼ê³  ì¢…ë£Œ
  }
  if (story.value.trim() === "") {
    showFieldError(story, "ë¸Œëœë“œ ìŠ¤í† ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    showToast("ë¸Œëœë“œ ìŠ¤í† ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }
  if (concept.value.trim() === "") {
    showFieldError(concept, "ë¸Œëœë“œ ì»¨ì…‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    showToast("ë¸Œëœë“œ ì»¨ì…‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }

  /* ======================================
      ğŸ”µ STEP 2 â€” ì²« ë²ˆì§¸ ë¯¸ì¶©ì¡± í•­ëª©
  =======================================*/
  if (selectedTags.length === 0) {
    showToast("í†¤ & ë¬´ë“œ íƒœê·¸ë¥¼ 1ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.");
    return;
  }

  /* ======================================
      ğŸ”µ STEP 3 â€” ì²« ë²ˆì§¸ ë¯¸ì¶©ì¡± í•­ëª©
  =======================================*/
  if (targetCustomer.value.trim() === "") {
    showFieldError(targetCustomer, "íƒ€ê¹ƒ ê³ ê°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    showToast("íƒ€ê¹ƒ ê³ ê°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }
  if (selectedSpreadTags.length === 0) {
    showToast("í™•ì‚° ê²½ë¡œ ì˜µì…˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
    return;
  }
  if (expandPlan.value.trim() === "") {
    showFieldError(expandPlan, "í–¥í›„ í™•ì¥ ê³„íšì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    showToast("í–¥í›„ í™•ì¥ ê³„íšì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }

  /* ======================================
      ğŸ”µ ëª¨ë“  ë‹¨ê³„ í†µê³¼ â†’ ì„œë²„ ì €ì¥
  =======================================*/
const payload = {
  keywords,
  story: story.value,
  concept: concept.value,
  tone_tags: selectedTags,
  target_customer: targetCustomer.value,
  spread_tags: selectedSpreadTags,
  expand_plan: expandPlan.value,
};

try {
  const res = await fetch("http://localhost:3000/brand/save", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    credentials: "include",
    body: JSON.stringify(payload),
  });

  const data = await res.json();

  if (data.success) {
    showToast("ë¸Œëœë“œ ì„¤ê³„ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!", "success");

    // ğŸ”µ ì„±ê³µ í›„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™í•˜ë ¤ë©´ ì—¬ê¸°ì— ì¶”ê°€
     setTimeout(() => {
     window.location.href = "brand-roadmap.html";
     }, 1500);

  } else {
    showToast("ì„œë²„ ì˜¤ë¥˜: ì €ì¥ ì‹¤íŒ¨");
  }
} catch (err) {
  showToast("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
}
};


/* ================================
   ğŸ”´ ì…ë ¥ í•„ë“œ ì—ëŸ¬ í‘œì‹œ
================================ */
function showFieldError(inputEl, message) {
  if (!inputEl) return;

  inputEl.classList.add("input-error");

  let msg = document.createElement("div");
  msg.className = "alert-text";
  msg.textContent = message;

  // ê¸°ì¡´ ì•ˆë‚´ë¬¸ ì œê±°
  if (inputEl.nextElementSibling?.classList.contains("alert-text")) {
    inputEl.nextElementSibling.remove();
  }

  inputEl.after(msg);
}

function resetError(inputEl) {
  if (!inputEl) return;

  inputEl.classList.remove("input-error");

  if (inputEl.nextElementSibling?.classList.contains("alert-text")) {
    inputEl.nextElementSibling.remove();
  }
}

/* ================================
   ğŸ”µ í† ìŠ¤íŠ¸ í ì‹œìŠ¤í…œ
   (ì•ŒëŒì´ ìˆœì„œëŒ€ë¡œ í•˜ë‚˜ì”© ëœ¨ë„ë¡)
================================ */
let toastQueue = [];
let toastActive = false;

function showToast(message, type = "error") {
  toastQueue.push({ message, type });
  processToastQueue();
}

function processToastQueue() {
  if (toastActive) return;
  if (toastQueue.length === 0) return;

  toastActive = true;
  const { message, type } = toastQueue.shift();

  const box = document.createElement("div");
  box.style.position = "fixed";
  box.style.top = "20px";
  box.style.right = "20px";
  box.style.padding = "14px 20px";
  box.style.borderRadius = "10px";
  box.style.fontWeight = "700";
  box.style.fontSize = "15px";
  box.style.zIndex = "9999";
  box.style.boxShadow = "0 4px 12px rgba(0,0,0,0.18)";
  box.style.opacity = "0";
  box.style.transition = "opacity 0.3s";

  if (type === "success") {
    box.style.background = "#0056ff";
    box.style.color = "#fff";
  } else {
    box.style.background = "#ff4d4d";
    box.style.color = "#fff";
  }

  box.textContent = message;
  document.body.appendChild(box);

  // fade-in
  setTimeout(() => {
    box.style.opacity = "1";
  }, 10);

  // 2ì´ˆ ìœ ì§€ í›„ fade-out
  setTimeout(() => {
    box.style.opacity = "0";
    setTimeout(() => {
      box.remove();
      toastActive = false;
      processToastQueue(); // ë‹¤ìŒ í† ìŠ¤íŠ¸ ì‹¤í–‰
    }, 400);
  }, 2000);
}

/* ğŸ”¥ ì´ˆê¸° ì„¸íŒ… */
renderToneCategories();
renderSpreadCategories();
syncResults();
</script>

</body>
</html>
