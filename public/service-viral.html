<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SNS ë°”ì´ëŸ´ ìº í˜ì¸ íŒ¨í‚¤ì§€ ì „ë¬¸ê°€ ì¶”ì²œ | BlueOn</title>

<style>
body {
  font-family: "Noto Sans KR", sans-serif;
  background:#f9fafb;
  margin:0;
}

/* HEADER */
header {
  padding:20px 60px;
  background:#fff;
  border-bottom:1px solid #e5e7eb;
  font-size:22px;
  font-weight:800;
  color:#0056ff;
  cursor:pointer;
}

/* SERVICE CARD */
.service-card {
  width:100%;
  background:white;
  border-radius:14px;
  border:1px solid #e5e7eb;
  padding:20px;
  margin:20px auto;
  max-width:1200px;
  cursor:pointer;
  transition:0.2s;
}
.service-card:hover {
  border-color:#b0c8ff;
}

.service-top {
  display:flex;
  align-items:flex-start;
  gap:20px;
}

.service-thumb {
  width:180px;
  height:140px;
  border-radius:12px;
  object-fit:cover;
  background:#eee;
}

.service-info { flex:1; }

.service-title {
  font-size:20px;
  font-weight:800;
  margin-bottom:6px;
}

.service-price {
  font-size:16px;
  color:#0056ff;
  font-weight:700;
  margin-top:4px;
}

/* í•„í„° ë²„íŠ¼ */
.sub-filter-wrap {
  display:flex;
  gap:12px;
  margin:20px 0;
  max-width:1200px;
  padding-left:390px;
}

.sub-btn {
  padding:10px 18px;
  background:#f5f7fa;
  border:1px solid #e5e7eb;
  border-radius:25px;
  font-size:14px;
  cursor:pointer;
  transition:0.2s;
}
.sub-btn.active {
  background:#eaf1ff;
  border-color:#3b82f6;
  color:#2563eb;
  font-weight:700;
}
</style>
</head>

<body>

<header onclick="location.href='index.html'">BlueOn</header>

<h2 style="max-width:1200px;margin:30px auto 10px;font-size:22px;font-weight:800; padding-left:60px;">
 SNS ëœë”© í˜ì´ì§€ ì œì‘ ì „ë¬¸ê°€ ì¶”ì²œ
</h2>

<!-- ğŸ”µ í•˜ìœ„ ì¹´í…Œê³ ë¦¬ í•„í„° -->
<div class="sub-filter-wrap">

  <button class="sub-btn" data-sub="SNS ëœë”© í˜ì´ì§€ ì œì‘">
    SNS ëœë”© í˜ì´ì§€ ì œì‘
  </button>

  <button class="sub-btn" data-sub="SNS ë°”ì´ëŸ´ ë§ˆì¼€íŒ…">
    SNS ë°”ì´ëŸ´ ë§ˆì¼€íŒ…
  </button>

  <button class="sub-btn" data-sub="SNS í™œìš© ì´ë²¤íŠ¸ ê¸°íš">
    SNS í™œìš© ì´ë²¤íŠ¸ ê¸°íš
  </button>


</div>


<div id="serviceList"></div>


<script>
const API = "https://blueon.up.railway.app";

/* ì´ë¯¸ì§€ íŒŒì„œ */
function parseImages(raw) {
  if (!raw) return [];
  if (Array.isArray(raw)) return raw;

  try {
    const arr = JSON.parse(raw);
    return Array.isArray(arr) ? arr : [];
  } catch (e) {}

  if (typeof raw === "string" && raw.startsWith("/uploads/")) {
    return [raw];
  }

  return [];
}

/* ğŸ”µ ì„œë¹„ìŠ¤ ë¶ˆëŸ¬ì˜¤ê¸° */
async function loadServices(sub) {
  try {
    const res = await fetch(`${API}/services/list?sub=${encodeURIComponent(sub)}`);
    const data = await res.json();

    if (!data.success || !data.services.length) {
      document.getElementById("serviceList").innerHTML = `
        <p style="text-align:center;color:#777;margin-top:40px;">
          í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.
        </p>`;
      return;
    }

    renderServices(data.services);

  } catch (err) {
    console.error("loadServices ì˜¤ë¥˜:", err);
  }
}

/* ğŸ”µ í•„í„° ë²„íŠ¼ í´ë¦­ */
document.addEventListener("click", (e) => {
  if (!e.target.classList.contains("sub-btn")) return;

  document.querySelectorAll(".sub-btn").forEach(btn => btn.classList.remove("active"));
  e.target.classList.add("active");

  loadServices(e.target.dataset.sub);
});

/* ğŸ”µ ì²« ë¡œë”©: ì²« ë²ˆì§¸ ë²„íŠ¼ ê¸°ì¤€ìœ¼ë¡œ ìë™ ì‹¤í–‰ */
document.addEventListener("DOMContentLoaded", () => {
  const firstBtn = document.querySelector(".sub-btn");
  if (firstBtn) {
    firstBtn.classList.add("active");
    loadServices(firstBtn.dataset.sub);
  }
});


/* ğŸ”µ ì¹´ë“œ ë Œë”ë§ */
function renderServices(list) {
  const box = document.getElementById("serviceList");
  box.innerHTML = "";

  list.forEach(svc => {

    let thumbSrc = "/assets/default_service.png";
    const imgs = parseImages(svc.main_images);
    if (imgs.length > 0) thumbSrc = imgs[0];

    const priceBasic = svc.price_basic
      ? Number(svc.price_basic).toLocaleString() + "ì›"
      : "ê°€ê²© í˜‘ì˜";

    const card = document.createElement("div");
    card.className = "service-card";

    card.innerHTML = `
      <div class="service-top">
        <img src="${thumbSrc}" class="service-thumb">
        <div class="service-info">
          <div class="service-title">${svc.title}</div>
          <div class="service-price">${priceBasic}</div>
        </div>
      </div>
    `;

    /* ìƒì„¸í˜ì´ì§€ ì´ë™ */
    card.addEventListener("click", () => {
      location.href = "service-detail.html?id=" + svc.id;
    });

    box.appendChild(card);
  });
}
</script>

</body>
</html>
